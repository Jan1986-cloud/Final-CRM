"use strict";exports.id=51,exports.ids=[51],exports.modules={71669:(e,t,a)=>{a.d(t,{C5:()=>w,MJ:()=>p,Rr:()=>b,eI:()=>_,lR:()=>g,lV:()=>d,zB:()=>u});var r=a(60687),i=a(43210),n=a(11329),o=a(27605),l=a(4780),c=a(80013);let d=o.Op,s=i.createContext({}),u=({...e})=>(0,r.jsx)(s.Provider,{value:{name:e.name},children:(0,r.jsx)(o.xI,{...e})}),f=()=>{let e=i.useContext(s),t=i.useContext(m),{getFieldState:a,formState:r}=(0,o.xW)(),n=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...n}},m=i.createContext({}),_=i.forwardRef(({className:e,...t},a)=>{let n=i.useId();return(0,r.jsx)(m.Provider,{value:{id:n},children:(0,r.jsx)("div",{ref:a,className:(0,l.cn)("space-y-2",e),...t})})});_.displayName="FormItem";let g=i.forwardRef(({className:e,...t},a)=>{let{error:i,formItemId:n}=f();return(0,r.jsx)(c.J,{ref:a,className:(0,l.cn)(i&&"text-destructive",e),htmlFor:n,...t})});g.displayName="FormLabel";let p=i.forwardRef(({...e},t)=>{let{error:a,formItemId:i,formDescriptionId:o,formMessageId:l}=f();return(0,r.jsx)(n.DX,{ref:t,id:i,"aria-describedby":a?`${o} ${l}`:`${o}`,"aria-invalid":!!a,...e})});p.displayName="FormControl";let b=i.forwardRef(({className:e,...t},a)=>{let{formDescriptionId:i}=f();return(0,r.jsx)("p",{ref:a,id:i,className:(0,l.cn)("text-sm text-muted-foreground",e),...t})});b.displayName="FormDescription";let w=i.forwardRef(({className:e,children:t,...a},i)=>{let{error:n,formMessageId:o}=f(),c=n?String(n?.message??""):t;return c?(0,r.jsx)("p",{ref:i,id:o,className:(0,l.cn)("text-sm font-medium text-destructive",e),...a,children:c}):null});w.displayName="FormMessage"},80013:(e,t,a)=>{a.d(t,{J:()=>d});var r=a(60687),i=a(43210),n=a(78148),o=a(24224),l=a(4780);let c=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.b,{ref:a,className:(0,l.cn)(c(),e),...t}));d.displayName=n.b.displayName},81223:(e,t,a)=>{let r,i;a.r(t),a.d(t,{"4046ba43fa891420573b4c6e35d6c06acbcaf3ee96":()=>R,"4061b5700d6dd240bd70a1a5dc3fd8a4d67ec7eccb":()=>B,"40a16a3d45aa9537093c128bc1eba9ed260b3ed1e4":()=>Y,"40b1d474d95f100735497546519a62008f54dc2245":()=>D,"40fab5f459d5257b61b41061aaeee61cc6a0870dd7":()=>$,"6006aa8a4ebf63c89b48cc25c408372c7cf73dc5df":()=>z,"70b68c8d6d2267da2c14b924bc9e52498660560ddb":()=>J});var n=a(91199);a(42087);var o=a(7944),l=a(46675),c=a.n(l);let d=!1,s=process.env.FIREBASE_SERVICE_ACCOUNT_JSON_BASE64;if(s)try{let e=Buffer.from(s,"base64").toString("utf-8");i=JSON.parse(e)}catch(e){console.error("!!! Error parsing FIREBASE_SERVICE_ACCOUNT_JSON_BASE64. Make sure it's a valid Base64 encoded service account JSON.",e.message)}if(i?.project_id&&i?.client_email&&i?.private_key)try{c().apps.length||(c().initializeApp({credential:c().credential.cert(i)}),console.log("Firebase Admin SDK initialized successfully.")),r=c().firestore(),d=!0}catch(e){console.error("!!! Firebase Admin SDK initialization failed:",e.message),d=!1}else{let e={project_id:process.env.FIREBASE_PROJECT_ID,client_email:process.env.FIREBASE_CLIENT_EMAIL,private_key:(process.env.FIREBASE_PRIVATE_KEY||"").replace(/\\n/g,"\n")};if(e.project_id&&e.client_email&&e.private_key)try{c().apps.length||(c().initializeApp({credential:c().credential.cert(e)}),console.log("Firebase Admin SDK initialized successfully using legacy variables.")),r=c().firestore(),d=!0}catch(e){console.error("!!! Firebase Admin SDK initialization failed:",e.message),d=!1}else console.warn("********************************************************************************************************"),console.warn("*** Firebase Admin credentials not set. App is running in OFFLINE MODE. ********************************"),console.warn("*** TO CONNECT TO FIREBASE: ****************************************************************************"),console.warn("*** 1. Get your service account JSON file from Firebase Console. ***************************************"),console.warn("*** 2. Encode its content to Base64 (e.g., at https://www.base64encode.org/). **************************"),console.warn("*** 3. Add to .env: FIREBASE_SERVICE_ACCOUNT_JSON_BASE64=<your_base64_string> **************************"),console.warn("********************************************************************************************************")}d||(r=new Proxy({},{get(e,t){throw Error(`Firebase Admin SDK not initialized. Cannot access 'adminDb.${String(t)}'. Please check your server logs for configuration instructions.`)}}));var u=a(61985);function f(e){let t=e.data(),a=e=>{if(!e)return e;for(let t in e)e[t]&&"function"==typeof e[t].toDate?e[t]=e[t].toDate().toISOString():"object"==typeof e[t]&&null!==e[t]&&a(e[t]);return e};return{id:e.id,...a(t)}}let m=!1,_=()=>{m||(console.warn("********************************************************************************************************"),console.warn("*** PROJECT CONFIGURATION ERROR: Firestore is in Datastore Mode. *************************************"),console.warn("*** This application requires Firestore in Native Mode. You must create a new project. ***************"),console.warn("*** Falling back to OFFLINE MODE. Data is not being saved. *******************************************"),console.warn("********************************************************************************************************"),m=!0)},g=e=>!!e.message?.includes("Firestore in Datastore Mode"),p={clients:[{id:"mock_1",name:"Globex Corporation",email:"contact@globex.com",phone:"555-0101",address:{street:"123 Industrial Way",city:"Springfield",state:"IL",zip:"62701"},status:"Active",createdAt:new Date(Date.now()-2592e6).toISOString(),notes:"High-value client, potential for a large-scale project in Q3."},{id:"mock_2",name:"Stark Industries",email:"pepper.potts@stark.com",phone:"555-0102",address:{street:"10880 Malibu Point",city:"Malibu",state:"CA",zip:"90265"},status:"Lead",createdAt:new Date(Date.now()-432e6).toISOString(),notes:"Initial contact made. Follow up scheduled for next week."}],articles:[{id:"mock_art_1",artikel_naam:"Pro Widget",artikel_omschrijving_kort:"The latest and greatest widget.",artikel_omschrijving_lang:"A full description of the Pro Widget.",artikel_fotos:[],artikel_urls:[],artikel_magazijnlocatie:"A5-3",artikel_prijs_excl_btw:199.99,artikel_korting_percentage:0,artikel_btw_percentage:21,artikel_eenheid:"piece"},{id:"mock_art_2",artikel_naam:"Basic Gadget",artikel_omschrijving_kort:"A reliable, everyday gadget.",artikel_omschrijving_lang:"A full description of the Basic Gadget.",artikel_fotos:[],artikel_urls:[],artikel_magazijnlocatie:"B2-1",artikel_prijs_excl_btw:49.95,artikel_korting_percentage:5,artikel_btw_percentage:21,artikel_eenheid:"piece"}],documents:[]};async function b(e){if(!d){console.warn(`Firebase not configured. Using mock data for getClientById(${e}).`);let t=p.clients.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}try{let t=await r.collection("clients").doc(e).get();if(!t.exists)return null;return f(t)}catch(t){if(g(t)){_();let t=p.clients.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}return console.error(`Error fetching client ${e}:`,t),null}}async function w(e){if(!d)throw Error("Firebase not configured. Cannot add client in offline mode.");let t={...e,createdAt:new Date};return{id:(await r.collection("clients").add(t)).id,...t,createdAt:t.createdAt.toISOString()}}async function k(e,t){if(!d)throw Error("Firebase not configured. Cannot update client in offline mode.");let a=r.collection("clients").doc(e);return await a.update(t),f(await a.get())}async function h(e){if(!d)throw Error("Firebase not configured. Cannot delete client in offline mode.");await r.collection("clients").doc(e).delete()}function y(e){let t=0,a=0;for(let r of e)t+=r.totaal_excl_btw,a+=r.totaal_excl_btw*(r.btw_percentage/100);let r=t+a;return{subtotal:t,vat:a,total:r}}async function v(e,t){if(!d)throw Error("Firebase not configured. Cannot create document in offline mode.");let a=await b(e);if(!a)throw Error("Client not found");let i={Quote:"Q","Work Order":"WO",Invoice:"I"}[t],n=(await r.collection("documenten").where("document_type","==",t).get()).size,o={document_type:t,document_nummer:`${i}-${new Date().getFullYear()}${(new Date().getMonth()+1).toString().padStart(2,"0")}-${(n+1).toString().padStart(3,"0")}`,document_datum:new Date,document_status:"concept",klant_id:e,regels:[],totaal_subtotaal_excl_btw:0,totaal_btw_bedrag:0,totaal_incl_btw:0};return{id:(await r.collection("documenten").add(o)).id,...o,clientName:a.name,document_datum:o.document_datum.toISOString()}}async function E(e,t,a){if(!d)throw Error("Firebase not configured. Cannot add document line in offline mode.");let i=await j(t);if(!i)throw Error("Article not found.");let n=i.artikel_prijs_excl_btw*a*(1-i.artikel_korting_percentage/100),o={id:(0,u.A)(),artikel_id:t,omschrijving:i.artikel_naam,aantal:a,eenheid:i.artikel_eenheid,prijs_per_eenheid_excl_btw:i.artikel_prijs_excl_btw,btw_percentage:i.artikel_btw_percentage,korting_percentage:i.artikel_korting_percentage,totaal_excl_btw:n},l=r.collection("documenten").doc(e),c=await l.get();if(!c.exists)throw Error("Document not found.");let s=[...c.data()?.regels||[],o],{subtotal:f,vat:m,total:_}=y(s);await l.update({regels:s,totaal_subtotaal_excl_btw:f,totaal_btw_bedrag:m,totaal_incl_btw:_})}async function I(e,t){if(!d)throw Error("Firebase not configured. Cannot delete document line in offline mode.");let a=r.collection("documenten").doc(e),i=await a.get();if(!i.exists)throw Error("Document not found.");let n=(i.data()?.regels||[]).filter(e=>e.id!==t),{subtotal:o,vat:l,total:c}=y(n);await a.update({regels:n,totaal_subtotaal_excl_btw:o,totaal_btw_bedrag:l,totaal_incl_btw:c})}async function j(e){if(!d){console.warn(`Firebase not configured. Using mock data for getArticleById(${e}).`);let t=p.articles.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}try{let t=await r.collection("artikelen").doc(e).get();if(!t.exists)return null;return f(t)}catch(t){if(g(t)){_();let t=p.articles.find(t=>t.id===e);return t?JSON.parse(JSON.stringify(t)):null}return console.error(`Error fetching article ${e}:`,t),null}}async function S(e){if(!d)throw Error("Firebase not configured. Cannot add article in offline mode.");return{id:(await r.collection("artikelen").add(e)).id,...e}}async function A(e,t){if(!d)throw Error("Firebase not configured. Cannot update article in offline mode.");let a=r.collection("artikelen").doc(e);return await a.update(t),f(await a.get())}async function F(e){if(!d)throw Error("Firebase not configured. Cannot delete article in offline mode.");await r.collection("artikelen").doc(e).delete()}var x=a(68567),O=a(90141),N=a(33331);let C=x.Ik({id:x.Yj().optional(),name:x.Yj().min(2,"Name must be at least 2 characters."),email:x.Yj().email("Invalid email address."),phone:x.Yj().min(10,"Phone number is too short."),address:x.Ik({street:x.Yj().min(2,"Street is required."),city:x.Yj().min(2,"City is required."),state:x.Yj().min(2,"State is required."),zip:x.Yj().min(5,"Zip code is required.")}),status:x.k5(["Lead","Active","Inactive"]),notes:x.Yj().optional()});async function D(e){let t,a=C.safeParse(e);if(!a.success)throw Error("Invalid client data");let{id:r,...i}=a.data;return t=r?await k(r,i):await w(i),(0,o.revalidatePath)("/clients"),r&&(0,o.revalidatePath)(`/clients/${r}`),(0,o.revalidatePath)("/documents"),t}async function Y(e){if(!e)throw Error("Client ID is required");await h(e),(0,o.revalidatePath)("/clients"),(0,o.revalidatePath)("/documents")}async function R(e){if(!e.klant_id||!e.document_type)throw Error("Client and document type are required");let t=await v(e.klant_id,e.document_type);(0,o.revalidatePath)("/documents"),(0,O.redirect)(`/documents/${t.id}`)}let P=x.Ik({id:x.Yj().optional(),artikel_naam:x.Yj().min(2,"Name must be at least 2 characters."),artikel_omschrijving_kort:x.Yj().min(5,"Short description is required."),artikel_omschrijving_lang:x.Yj().optional(),artikel_fotos:x.YO(x.Ik({foto_url:x.Yj().url("Invalid URL format.").or(x.eu("")),foto_omschrijving:x.Yj()})).optional(),artikel_urls:x.YO(x.Ik({value:x.Yj().url("Invalid URL format.").or(x.eu(""))})).optional(),artikel_magazijnlocatie:x.Yj().optional(),artikel_prijs_excl_btw:x.au.number().min(0,"Price must be a positive number."),artikel_korting_percentage:x.au.number().min(0).max(100).optional().default(0),artikel_btw_percentage:x.au.number().min(0),artikel_eenheid:x.Yj().min(1,"Unit is required.")});async function B(e){let t,a={...e,artikel_urls:e.artikel_urls?.map(e=>e.value).filter(Boolean)||[],artikel_fotos:e.artikel_fotos?.filter(e=>e.foto_url)||[]},r=P.extend({artikel_urls:x.YO(x.Yj().url()).optional(),artikel_fotos:x.YO(x.Ik({foto_url:x.Yj().url(),foto_omschrijving:x.Yj()})).optional()}).safeParse(a);if(!r.success)throw console.error(r.error.flatten().fieldErrors),Error("Invalid article data");let{id:i,...n}=r.data;return t=i?await A(i,n):await S(n),(0,o.revalidatePath)("/articles"),i&&(0,o.revalidatePath)(`/articles/${i}`),t}async function $(e){if(!e)throw Error("Article ID is required");await F(e),(0,o.revalidatePath)("/articles")}async function J(e,t,a){if(!e||!t||!a)throw Error("Document ID, Article ID, and quantity are required.");await E(e,t,a),(0,o.revalidatePath)(`/documents/${e}`)}async function z(e,t){if(!e||!t)throw Error("Document ID and Line ID are required.");await I(e,t),(0,o.revalidatePath)(`/documents/${e}`)}(0,N.D)([D,Y,R,B,$,J,z]),(0,n.A)(D,"40b1d474d95f100735497546519a62008f54dc2245",null),(0,n.A)(Y,"40a16a3d45aa9537093c128bc1eba9ed260b3ed1e4",null),(0,n.A)(R,"4046ba43fa891420573b4c6e35d6c06acbcaf3ee96",null),(0,n.A)(B,"4061b5700d6dd240bd70a1a5dc3fd8a4d67ec7eccb",null),(0,n.A)($,"40fab5f459d5257b61b41061aaeee61cc6a0870dd7",null),(0,n.A)(J,"70b68c8d6d2267da2c14b924bc9e52498660560ddb",null),(0,n.A)(z,"6006aa8a4ebf63c89b48cc25c408372c7cf73dc5df",null)}};